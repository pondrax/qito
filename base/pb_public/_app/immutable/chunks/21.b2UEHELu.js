import"./disclose-version.15-3dQtY.js";import{u as H,a3 as K,r as L,p as B,a as C,A as c,y as F,s as G,q as I,z as J}from"./runtime.bbI-llpg.js";import{e as N}from"./each.EYzjG2Rp.js";import{e as Q,g as M,c as p,E as R,a,w as U,P as T,x as V,p as W,o as _,b as e,D as X,z as Y,d as m}from"./render.xdaRgOar.js";import{u as Z,d as f,s as $}from"./db.DaXTXu79.js";import{o as aa}from"./main-client.tx5f1FhV.js";var ea=m('<div grid="~ cols-[1fr_auto]" gap-2="" place-items-end=""><div avatar="" w-10="" rounded-full="" order-2=""><img src="/avatar.png" alt="avatar"></div> <div><div chat-bubble="" bg-base-b="" break-all=""><!></div></div></div>'),ra=m('<div grid="~ cols-[auto_1fr]" gap-2="" place-items-start=""><div avatar="" w-10="" rounded-full=""><img src="/avatar.png" alt="avatar"></div> <div><div chat-bubble="" bg-base-b="" break-all=""><!></div></div></div>'),sa=m('<div min-h-screen="" px-2=""><div py-5=""><h1 text-xl="">Messages</h1></div> <div min-h-80vh="" pb-20=""><div grid="" gap-3=""></div></div> <div sticky="" bottom-5="" left-0="" right-0=""><form action="?/messages"><input name="owner" type="hidden"> <div group-x-rounded=""><input name="content" input="" placeholder="Type message" autocomplete="off"> <button btn=""><i i-bx-send=""></i></button></div></form></div></div>');function ta(b,j){C(j,!1);const g={};H(g);const h=()=>G(Z,"$user",g);let y=I();aa(async()=>{await w(),f.collection("messages").subscribe("*",()=>{w()})}),K(()=>{f.collection("messages").unsubscribe("*")});async function w(){J(y,await f.collection("messages").getList(1,30,{expand:"owner,to",sort:"-created",requestKey:"refresh"}))}var x=_(b,!0,sa),q=a(x),k=e(e(q)),O=a(k),P=e(e(k)),t=a(P),i=a(t);R(i);var S=e(e(i)),A=a(S);Q(A,!0);var o;L(()=>{o!==(o=h()?.id)&&(i.value=o)}),N(O,()=>F(y)?.items?.reverse()||[],9,(z,d,ia)=>{var D=X(z),E=Y(D);U(E,()=>h()?.id==c(d).owner,r=>{var s=_(r,!0,ea),v=a(s),n=e(e(v)),l=a(n),u=a(l);T(u,()=>c(d).content,!1),p(r,s)},r=>{var s=_(r,!0,ra),v=a(s),n=e(e(v)),l=a(n),u=a(l);T(u,()=>c(d).content,!1),p(r,s)}),V(z,D)},null),M("submit",t,W($),!1),M("reset",t,()=>{window.scrollTo(0,document.body.scrollHeight)},!1),p(b,x),B()}const ca=Object.freeze(Object.defineProperty({__proto__:null,default:ta},Symbol.toStringTag,{value:"Module"}));export{ta as _,ca as a};
