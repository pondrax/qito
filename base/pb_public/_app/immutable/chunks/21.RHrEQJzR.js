import"./disclose-version.15-3dQtY.js";import{u as E,a3 as F,r as H,p as K,a as L,A as c,g as C,s as G,x as I,d as J}from"./runtime.N9sK9yCX.js";import{e as N}from"./each.-e9gUnfe.js";import{f as Q,i as T,c as p,F as R,a,y as U,P as z,z as V,j as W,o as f,b as e,E as X,B as Y,d as m}from"./render.FNm7pgUH.js";import{u as Z,d as _,s as $}from"./db.D4TSvIhG.js";import{o as aa}from"./main-client.3hV4Kem7.js";var ea=m('<div grid="~ cols-[1fr_auto]" gap-2="" place-items-end=""><div avatar="" w-10="" rounded-full="" order-2=""><img src="/avatar.png" alt="avatar"></div> <div><div chat-bubble="" bg-base-b="" break-all=""><!></div></div></div>'),ra=m('<div grid="~ cols-[auto_1fr]" gap-2="" place-items-start=""><div avatar="" w-10="" rounded-full=""><img src="/avatar.png" alt="avatar"></div> <div><div chat-bubble="" bg-base-b="" break-all=""><!></div></div></div>'),sa=m('<div min-h-screen="" px-2=""><div py-5=""><h1 text-xl="">Messages</h1></div> <div min-h-80vh="" pb-20=""><div grid="" gap-3=""></div></div> <div sticky="" bottom-5="" left-0="" right-0=""><form action="?/messages"><input name="owner" type="hidden"> <div group-x-rounded=""><input name="content" input="" placeholder="Type message" autocomplete="off"> <button btn=""><i i-bx-send=""></i></button></div></form></div></div>');function ta(b,D){L(D,!1);const g={};E(g);const h=()=>G(Z,"$user",g);let y=I();aa(async()=>{await w(),_.collection("messages").subscribe("*",()=>{w()})}),F(()=>{_.collection("messages").unsubscribe("*")});async function w(){J(y,await _.collection("messages").getList(1,30,{expand:"owner,to",sort:"-created",requestKey:"refresh"}))}var x=f(b,!0,sa),O=a(x),k=e(e(O)),P=a(k),S=e(e(k)),t=a(S),i=a(t);R(i);var q=e(e(i)),A=a(q);Q(A,!0);var o;H(()=>{o!==(o=h()?.id)&&(i.value=o)}),N(P,()=>C(y)?.items?.reverse()||[],9,(j,d,ia)=>{var M=X(j),B=Y(M);U(B,()=>h()?.id==c(d).owner,r=>{var s=f(r,!0,ea),v=a(s),n=e(e(v)),l=a(n),u=a(l);z(u,()=>c(d).content,!1),p(r,s)},r=>{var s=f(r,!0,ra),v=a(s),n=e(e(v)),l=a(n),u=a(l);z(u,()=>c(d).content,!1),p(r,s)}),V(j,M)},null),T("submit",t,W($),!1),T("reset",t,()=>{window.scrollTo(0,document.body.scrollHeight)},!1),p(b,x),K()}const ca=Object.freeze(Object.defineProperty({__proto__:null,default:ta},Symbol.toStringTag,{value:"Module"}));export{ta as _,ca as a};
