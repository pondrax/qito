import"./disclose-version.15-3dQtY.js";import{u as Ua,r as ia,p as Ja,d as f,x as ra,e as D,a as Qa,a1 as da,g as i,s as qa,A as d,a2 as Va}from"./runtime.N9sK9yCX.js";import{e as va}from"./each.-e9gUnfe.js";import{t as g,G as la,i as oa,y as F,z as sa,a as t,b as a,x as Wa,F as Pa,M as Xa,N as na,O as Ya,c as w,B as ua,C as M,o as y,s as _a,D as c,j as Za,g as $a,P as at,H as tt,E as Sa,d as b}from"./render.FNm7pgUH.js";import{d as G,l as H,t as Da}from"./db.D4TSvIhG.js";import{o as et}from"./main-client.3hV4Kem7.js";import{t as it}from"./lang.7t8SORkE.js";import{f as rt,a as Ma}from"./fnSelect.wqP3uKO_.js";var dt=(L,N)=>f(N,!1),vt=b('<div><iframe title="SS"></iframe></div>'),lt=b('<form><h1 text-lg="" mb-3=""> </h1> <div h-80vh="" overflow-auto=""><p pb-5=""> </p> <div grid="" grid-cols-1="" gap-5=""><div form-control="" max-w-full=""><span>Opsi Penilaian</span> <div><textarea input="" filter="" placeholder="Pilih Opsi" min-h-8="" rounded-box=""></textarea> <input type="hidden" selected> <div relative="" w-full=""><ul menu="" top-0="" hidden absolute="" bg-base="" h-48="" z-10="" overflow-auto="" rounded-box="" shadow=""><li option=""><label flex="" gap-2="" cursor-pointer=""><input type="checkbox" checkbox="" shrink-0="" tabindex="-1"> <div option-label=""></div></label></li></ul></div></div></div> <div form-control="" max-w-full=""><span>Keterangan</span> <textarea input="" rows="3" h-auto="" rounded-box=""></textarea></div> <div form-control="" max-w-full=""><input type="file" input="" multiple> <div><div carousel="" w-full="" rounded-box="" min-h-40vh="" border=""></div></div></div></div></div> <div><button btn="~ primary"><i></i> </button></div></form>'),ot=b('<div absolute="" top-0="" z-20="" w-full="" h-2="" bg-neutral="" animate-pulse="" animate-count-infinite=""></div>'),st=b('<tr sticky="" top-30="" bg-base-b="" h-20=""><th><div text-center=""> </div></th><th></th><td> </td><th></th><td></td></tr>'),nt=b('<div bg-base-a="" px-2="" rounded-box=""> </div>'),ut=b('<tr><td text-center=""><div> </div></td><td> </td><td><div tabindex="0" collapse="" collapse-arrow="" px-0=""><div collapse-title="" pr-2=""> </div> <div><p> </p></div></div> <div pl-3="" border-l-4="" mb-3="" whitespace-pre-wrap=""><!></div> <div flex="" flex-wrap="" gap-1=""><button btn="~ xs"><i i-bx-edit-alt=""></i></button> <!></div></td><td> </td><td w-64=""><div><textarea input="" filter="" placeholder="Pilih Opsi" min-h-8="" rounded-box=""></textarea> <input type="hidden" selected> <div relative="" w-full=""><ul menu="" top-0="" hidden absolute="" bg-base="" h-48="" z-10="" overflow-auto="" rounded-box="" shadow=""><li option=""><label flex="" gap-2="" cursor-pointer=""><input type="checkbox" checkbox="" shrink-0="" tabindex="-1"> <div option-label=""></div></label></li></ul></div></div></td></tr>'),_t=b('<div modal=""><div w-5xl="" max-w-full=""><button modal-close="">&times;</button> <!></div></div> <div><div sticky="" top-0="" z-10="" bg-base-a="" pt-15="" pb-3=""><div flex="" gap-5=""><h1 text-xl=""> </h1> <button btn="~ sm circle outline" aria-label="Refresh" p-.5=""><i i-bx-refresh="" animate-reverse=""></i></button></div> <div><div flex=""><a href="../" btn="~ xs"> </a></div></div></div> <div bg-base="" min-h-70vh="" relative=""><!> <div><table table=""><tbody></tbody></table></div></div></div>',!0);const pt=!0;function ct(L,N){Qa(N,!1);const U={};Ua(U);const x=()=>qa(H,"$loading",U),j=()=>qa(it,"$t",U);let J=ra(),Q="",k=ra(),e=ra();et(async()=>{Q=location.search.replace("?",""),await V()});async function V(){D(H,!0),f(J,await G.collection("auditsResult").getList(1,500,{filter:`template.id="indeks_kami_4_2" && (audit.id = "${Q}" || audit = "")`,sort:"code",requestKey:"ikami"})),setTimeout(()=>D(H,!1),500)}async function pa(){D(H,!0);try{const v={template:i(e).template,audit:Q,question:i(e).id,answer:i(e).answer,score:i(e).score,media:i(e).file?[...i(e).file]:void 0};console.log(v,i(e)),i(e).aid?await G.collection("auditsDetail").update(i(e).aid,v):await G.collection("auditsDetail").create(v),D(Da,[{action:j()("action.saved")}])}catch(v){console.log(v),D(Da,[{error:v?.data}])}f(k,!1),V()}var ca=tt(L,!0,_t),I=ua(ca),ja=t(I),fa=t(ja),Ia=a(a(fa)),Ka=a(a(I)),ba=t(Ka),xa=t(ba),ma=t(xa),Ra=t(ma),ha=a(a(ma)),Ta=t(ha),Aa=a(a(xa)),Ba=t(Aa),Ca=t(Ba),Ea=t(Ca),Fa=a(a(ba)),ga=t(Fa),Ga=a(a(ga)),wa=t(Ga),Ha=t(wa);g(Ra,()=>j()("audit.indekskami.title")),g(Ea,()=>j()("all.list")),ia(()=>{M(Ta,"animate-spin",x()),M(wa,"opacity-50",x())}),la(I,(v,r)=>rt(v,r),()=>i(k)),oa("close",I,()=>f(k,!1),!1),fa.__click=[dt,k],F(Ia,()=>i(e),v=>{var r=y(v,!0,lt),W=t(r),K=t(W),R=a(a(W)),o=t(R),s=t(o),n=a(a(o)),m=t(n),O=t(m),u=a(a(O)),z=t(u),_=a(a(z));Pa(_);var q=a(a(m)),T=t(q),A=a(a(T));Xa(A);var X=a(a(q)),B=t(X),Y=a(a(B)),C=t(Y),Z=a(a(R)),$=t(Z),p=t($),aa=a(p);g(aa,()=>` ${_a(j()("save.btn"))}`),ia(()=>{c(K,`${_a(i(e).question)} (${_a(i(e).score)})`),c(s,i(e).hint),M(p,"i-bx-save",!x()),M(p,"i-bx-refresh",x()),M(p,"animate-spin",x())}),oa("submit",r,Za(pa),!1),la(u,(l,P)=>Ma(l,P),()=>i(e).options),na(_,()=>i(e).score,l=>da(e,i(e).score=l)),na(A,()=>i(e).answer,l=>da(e,i(e).answer=l)),Ya("files","change","set",B,()=>i(e).file,l=>da(e,i(e).file=l)),va(C,()=>i(e).media,9,(l,P,ya)=>{var S=y(l,!0,vt),ta=t(S);$a(ta,"src",()=>G.files.getUrl(i(e),d(P))),w(l,S)},null),w(v,r)},null),ha.__click=V,F(ga,x,v=>{var r=y(v,!0,ot);w(v,r)},null),va(Ha,()=>i(J)?.items||[],9,(v,r,W)=>{var K=Sa(v),R=ua(K);F(R,()=>d(r).meta?.title,o=>{var s=y(o,!0,st),n=t(s),m=t(n),O=t(m),u=a(n),z=a(u),_=t(z);g(O,()=>d(r).code.split("..").at(0)),g(_,()=>d(r).question),w(o,s)},o=>{var s=y(o,!0,ut),n=t(s),m=t(n),O=t(m),u=a(n),z=t(u),_=a(u),q=t(_),T=t(q),A=t(T),X=a(a(T)),B=t(X),Y=t(B),C=a(a(q)),Z=t(C);at(Z,()=>d(r).answer,!1);var $=a(a(C)),p=t($),aa=a(a(p)),l=a(_),P=t(l),ya=a(l),S=t(ya),ta=t(S),ea=a(a(ta));Pa(ea),ia(()=>{c(O,d(r).code),c(z,d(r).meta?.level||""),c(A,d(r).question),c(Y,d(r).hint),c(P,d(r).score)}),p.__click=()=>{f(e,d(r)),f(k,!0)},F(aa,()=>d(r).media.length>0,h=>{var E=Sa(h),La=ua(E);va(La,()=>d(r).media,1,(ka,Oa,ft)=>{var za=y(ka,!0,nt),Na=t(za);g(Na,()=>d(Oa).substr(0,d(Oa).lastIndexOf("_"))),w(ka,za)},null),sa(h,E)},null),la(S,(h,E)=>Ma(h,E),()=>d(r).options),na(ea,()=>d(r).score,h=>(d(r).score=h,Va(()=>i(J)?.items||[]))),oa("input",ea,()=>{f(e,d(r)),pa()},!1),w(o,s)}),sa(v,K)},null),sa(L,ca),Ja()}Wa(["click"]);const Ot=Object.freeze(Object.defineProperty({__proto__:null,default:ct,hidden:pt},Symbol.toStringTag,{value:"Module"}));export{ct as _,Ot as a};
