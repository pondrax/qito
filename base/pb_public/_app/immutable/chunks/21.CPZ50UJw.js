import{i as L,p as N,r as P,v as j,c as p,a as e,N as A,a1 as D,H as B,w as C,o as f,b as t,M as E,J as F,d as b}from"./disclose-version.DshyVd_Z.js";import{p as G,a as I,b as Q,m as R,x as m,g as U}from"./runtime.Cuj63gjm.js";import{e as V}from"./each.Oi8QW3YR.js";import{i as W}from"./if.BXalDDPe.js";import{u as X,s as Y}from"./store.DRzovyat.js";import{d as _,u as Z,s as $}from"./db.FEB5Gfq4.js";import{o as ee,a as ae}from"./main-client.DP_Dx0-m.js";var re=b('<div grid="~ cols-[1fr_auto]" gap-2="" place-items-end=""><div avatar="" w-10="" rounded-full="" order-2=""><img src="/avatar.png" alt="avatar"></div> <div><div chat-bubble="" bg-base-b="" break-all=""><!></div></div></div>'),te=b('<div grid="~ cols-[auto_1fr]" gap-2="" place-items-start=""><div avatar="" w-10="" rounded-full=""><img src="/avatar.png" alt="avatar"></div> <div><div chat-bubble="" bg-base-b="" break-all=""><!></div></div></div>'),se=b('<div min-h-screen="" px-2=""><div py-5=""><h1 text-xl="">Messages</h1></div> <div min-h-80vh="" pb-20=""><div grid="" gap-3=""></div></div> <div sticky="" bottom-5="" left-0="" right-0=""><form action="?/messages"><input name="owner" type="hidden"> <div group-x-rounded=""><input name="content" input="" placeholder="Type message" autocomplete="off"> <button btn=""><i i-bx-send=""></i></button></div></form></div></div>');function ie(g,H){I(H,!1);const h={};X(h);const y=()=>Y(Z,"$user",h);let w=R();ee(async()=>{await x(),_.collection("messages").subscribe("*",()=>{x()})}),ae(()=>{_.collection("messages").unsubscribe("*")});async function x(){Q(w,await _.collection("messages").getList(1,30,{expand:"owner,to",sort:"-created",requestKey:"refresh"}))}L();var M=f(g,!0,se),O=e(M),k=t(t(O,!0)),S=e(k),q=t(t(k,!0)),o=e(q),v=e(o);A(v);var z=t(t(v,!0)),J=e(z);N(J,!0);var d;P(()=>{var a;d!==(d=(a=y())==null?void 0:a.id)&&(v.value=d)}),V(S,()=>{var a,r;return((r=(a=U(w))==null?void 0:a.items)==null?void 0:r.reverse())||[]},9,(a,r,oe)=>{var T=E(a),K=F(T);W(K,()=>{var s;return((s=y())==null?void 0:s.id)==m(r).owner},s=>{var i=f(s,!0,re),n=e(i),u=t(t(n,!0)),l=e(u),c=e(l);D(c,()=>m(r).content,!1),p(s,i)},s=>{var i=f(s,!0,te),n=e(i),u=t(t(n,!0)),l=e(u),c=e(l);D(c,()=>m(r).content,!1),p(s,i)}),B(a,T)},null),j("submit",o,C(function(...a){const r=$;return r==null?void 0:r.apply(this,a)}),!1),j("reset",o,()=>{window.scrollTo(0,document.body.scrollHeight)},!1),p(g,M),G()}const fe=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"}));export{ie as _,fe as a};
