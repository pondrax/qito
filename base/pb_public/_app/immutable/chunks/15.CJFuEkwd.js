import{i as Ut,t as W,r as X,O as pt,v as S,H as Ct,Z as _t,_ as Ht,c as O,J as Jt,a,b as t,N as Y,K as f,o as $,a0 as Rt,s as C,L as b,w as Zt,q as At,a2 as Bt,P as Et,f as m,d as h}from"./disclose-version.DshyVd_Z.js";import{p as Ft,a as Gt,b as u,a1 as tt,g as e,m as at,x as d}from"./runtime.Cuj63gjm.js";import{e as et}from"./each.Oi8QW3YR.js";import{i as ft}from"./if.BXalDDPe.js";import{u as It,a as P,s as bt}from"./store.DRzovyat.js";import{d as H,l as J,t as mt}from"./db.FEB5Gfq4.js";import{o as Qt}from"./main-client.DP_Dx0-m.js";import{t as Vt}from"./lang.DpQJuId4.js";import{f as Wt,a as Xt}from"./fnSelect.CKqNMbYj.js";var Yt=h('<div><iframe title="SS"></iframe></div>'),ta=h('<form><h1 text-lg="" mb-3=""> </h1> <div h-80vh="" overflow-auto=""><p pb-5=""> </p> <div grid="" grid-cols-1="" gap-5=""><div form-control="" max-w-full=""><span>Opsi Penilaian</span> <div><textarea input="" filter="" placeholder="Pilih Opsi" min-h-8="" rounded-box=""></textarea> <input type="hidden" selected> <div relative="" w-full=""><ul menu="" top-0="" hidden absolute="" bg-base="" h-48="" z-10="" overflow-auto="" rounded-box="" shadow=""><li option=""><label flex="" gap-2="" cursor-pointer=""><input type="checkbox" checkbox="" shrink-0="" tabindex="-1"> <div option-label=""></div></label></li></ul></div></div></div> <div form-control="" max-w-full=""><span>Keterangan</span> <textarea input="" rows="3" h-auto="" rounded-box=""></textarea></div> <div form-control="" max-w-full=""><input type="file" input="" multiple> <div><div carousel="" w-full="" rounded-box="" min-h-40vh="" border=""></div></div></div></div></div> <div><button btn="~ primary"><i></i> </button></div></form>'),aa=h('<div absolute="" top-0="" z-20="" w-full="" h-2="" bg-neutral="" animate-pulse="" animate-count-infinite=""></div>'),ea=h('<div underline=""> </div>'),ia=h('<tr><td sticky="" left-0=""><input type="checkbox" checkbox=""></td><td></td><td><div><span badge=""> </span> </div></td><td> </td><td></td><td> </td></tr>'),ra=h('<div modal=""><div w-5xl="" max-w-full=""><button modal-close="">&times;</button> <!></div></div> <div><div sticky="" top-0="" z-10="" bg-base-a="" pt-15="" pb-3=""><div flex="" gap-5=""><h1 text-xl="">Sites Lists</h1> <button btn="~ sm circle outline" aria-label="Refresh" p-.5=""><i i-bx-refresh="" animate-reverse=""></i></button></div> <div><div flex=""><a href="./monitoring" btn="~ xs"> </a></div></div></div> <div bg-base="" min-h-70vh="" relative=""><!> <div relative="" bg-base="" z-20=""><table table="" w-full=""><thead><tr children-bg-base-b="" sticky="" top-0=""><th sticky="" left-0="" w-1="" aria-label="Checkbox" h-15=""><input type="checkbox" checkbox=""></th><th></th><th>Name</th><th>Organization</th><th>Status</th><th>Updated</th></tr></thead><tbody></tbody></table></div></div></div>',!0);function sa(it,ht){Gt(ht,!1);const R={};It(R);const c=()=>bt(J,"$loading",R),Z=()=>bt(Vt,"$t",R),xt=[];let x=at(),p=at([]),i=at();Qt(async()=>{await A()});async function A(){P(J,!0),u(x,await H.collection("sites").getList(1,500,{expand:"organization",sort:"name"})),setTimeout(()=>P(J,!1),500)}async function gt(){P(J,!0);try{const r={template:e(i).template,question:e(i).id,answer:e(i).answer,score:e(i).score,media:e(i).file?[...e(i).file]:void 0};console.log(r,e(i)),e(i).aid?await H.collection("auditsDetails").update(e(i).aid,r):await H.collection("auditsDetails").create(r),P(mt,[{action:Z()("action.saved")}])}catch(r){console.log(r),P(mt,[{error:r==null?void 0:r.data}])}u(i,!1),A()}Ut();var rt=Et(it,!0,ra),q=Jt(rt),wt=a(q),st=a(wt),yt=t(t(st,!0)),kt=t(t(q,!0)),ot=a(kt),dt=a(ot),zt=a(dt),lt=t(t(zt,!0)),St=a(lt),Ot=t(t(dt,!0)),$t=a(Ot),Pt=a($t),qt=m(a(Pt)),Dt=t(t(ot,!0)),nt=a(Dt),Lt=t(t(nt,!0)),vt=a(Lt),ut=a(vt),Mt=a(ut),jt=a(Mt),B=a(jt);Y(B);var Kt=t(ut);W(qt,()=>Z()("all.monitoring"));var E;X(()=>{var r;f(St,"animate-spin",c()),f(vt,"opacity-50",c()),E!==(E=e(p).length==((r=e(x))==null?void 0:r.items.length))&&(B.checked=E)}),pt(q,(r,s)=>Wt(r,s),()=>e(i)),S("close",q,()=>u(i,!1),!1),S("click",st,()=>u(i,!1),!1),ft(yt,()=>e(i),r=>{var s=$(r,!0,ta),F=a(s),D=a(F),g=t(t(F,!0)),v=a(g),G=m(a(v)),L=t(t(v,!0)),M=a(L),w=a(M),j=t(t(w,!0)),I=a(j),y=t(t(I,!0));Y(y);var K=t(t(M,!0)),N=a(K),T=t(t(N,!0));Rt(T);var Q=t(t(K,!0)),k=a(Q),o=t(t(k,!0)),n=a(o),z=t(t(g,!0)),U=a(z),_=a(U),Nt=t(_,!0);W(Nt,()=>` ${C(Z()("save.btn"))}`),X(()=>{b(D,`${C(e(i).question)} (${C(e(i).score)})`),b(G,e(i).hint),f(_,"i-bx-save",!c()),f(_,"i-bx-refresh",c()),f(_,"animate-spin",c())}),S("submit",s,Zt(gt),!1),pt(j,(l,V)=>Xt(l,V),()=>e(i).options),_t(y,()=>e(i).score,l=>tt(i,e(i).score=l)),_t(T,()=>e(i).answer,l=>tt(i,e(i).answer=l)),Ht("files","change","set",k,()=>e(i).file,l=>tt(i,e(i).file=l)),et(n,()=>e(i).media,9,(l,V,oa)=>{var ct=$(l,!0,Yt),Tt=a(ct);At(Tt,"src",()=>H.files.getUrl(e(i),d(V))),O(l,ct)},null),O(r,s)},null),S("click",lt,A,!1),ft(nt,c,r=>{var s=$(r,!0,aa);O(r,s)},null),S("click",B,()=>{var r,s;return e(p).length==((r=e(x))==null?void 0:r.items.length)?u(p,[]):u(p,(s=e(x))==null?void 0:s.items)},!1),et(Kt,()=>{var r;return((r=e(x))==null?void 0:r.items)||[]},9,(r,s,F)=>{var D=$(r,!0,ia),g=a(D),v=a(g);Y(v);var G=t(g),L=t(G),M=a(L),w=a(M),j=m(a(w)),I=t(w,!0),y=t(L),K=m(a(y)),N=t(y),T=t(N),Q=m(a(T)),k;X(()=>{var o,n,z;k!==(k=d(s))&&(v.value=(v.__value=d(s))==null?"":d(s)),f(w,"badge-primary",d(s).secure),b(j,d(s).secure?"https":"http"),b(I,` ${C(d(s).name)}`),b(K,(z=(n=(o=d(s))==null?void 0:o.expand)==null?void 0:n.organization)==null?void 0:z.name),b(Q,d(s).updated)}),Bt(xt,[],v,()=>(d(s),e(p)),o=>u(p,o)),et(N,()=>{var o,n;return((n=(o=d(s))==null?void 0:o.expand)==null?void 0:n.auditee)||[]},9,(o,n,z)=>{var U=$(o,!0,ea),_=m(a(U));W(_,()=>d(n).name),O(o,U)},null),O(r,D)},null),Ct(it,rt),Ft()}const ba=Object.freeze(Object.defineProperty({__proto__:null,default:sa},Symbol.toStringTag,{value:"Module"}));export{sa as _,ba as a};
