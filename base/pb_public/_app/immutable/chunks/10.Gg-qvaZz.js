import{i as Ft,t as y,r as it,O as rt,v as k,H as dt,Z as vt,_ as Gt,c as O,J as lt,a,b as t,K as j,o as q,N as zt,a0 as Qt,s as ot,L as x,w as Vt,q as Wt,a1 as Xt,P as Yt,f as s,M as Pt,d as h}from"./disclose-version.DshyVd_Z.js";import{p as $t,a as ta,b as m,a1 as st,g as i,m as nt,x as v,a2 as aa}from"./runtime.Cuj63gjm.js";import{e as ut}from"./each.Oi8QW3YR.js";import{i as A}from"./if.BXalDDPe.js";import{u as ea,a as I,s as St}from"./store.DRzovyat.js";import{d as B,l as C,t as Mt}from"./db.FEB5Gfq4.js";import{o as ia}from"./main-client.DP_Dx0-m.js";import{t as ra}from"./lang.DpQJuId4.js";import{f as da,a as Dt}from"./fnSelect.CKqNMbYj.js";var va=h('<div><iframe title="SS"></iframe></div>'),la=h('<form><h1 text-lg="" mb-3=""> </h1> <div h-80vh="" overflow-auto=""><p pb-5=""> </p> <div grid="" grid-cols-1="" gap-5=""><div form-control="" max-w-full=""><span>Opsi Penilaian</span> <div><textarea input="" filter="" placeholder="Pilih Opsi" min-h-8="" rounded-box=""></textarea> <input type="hidden" selected> <div relative="" w-full=""><ul menu="" top-0="" hidden absolute="" bg-base="" h-48="" z-10="" overflow-auto="" rounded-box="" shadow=""><li option=""><label flex="" gap-2="" cursor-pointer=""><input type="checkbox" checkbox="" shrink-0="" tabindex="-1"> <div option-label=""></div></label></li></ul></div></div></div> <div form-control="" max-w-full=""><span>Keterangan</span> <textarea input="" rows="3" h-auto="" rounded-box=""></textarea></div> <div form-control="" max-w-full=""><input type="file" input="" multiple> <div><div carousel="" w-full="" rounded-box="" min-h-40vh="" border=""></div></div></div></div></div> <div><button btn="~ primary"><i></i> </button></div></form>'),oa=h('<div absolute="" top-0="" z-20="" w-full="" h-2="" bg-neutral="" animate-pulse="" animate-count-infinite=""></div>'),sa=h('<tr sticky="" top-30="" bg-base-b="" h-20=""><th><div text-center=""> </div></th><th></th><td> </td><th></th><td></td></tr>'),na=h('<div bg-base-a="" px-2="" rounded-box=""> </div>'),ua=h('<tr><td text-center=""><div> </div></td><td> </td><td><div tabindex="0" collapse="" collapse-arrow="" px-0=""><div collapse-title="" pr-2=""> </div> <div><p> </p></div></div> <div pl-3="" border-l-4="" mb-3="" whitespace-pre-wrap=""><!></div> <div flex="" flex-wrap="" gap-1=""><button btn="~ xs"><i i-bx-edit-alt=""></i></button> <!></div></td><td> </td><td w-64=""><div><textarea input="" filter="" placeholder="Pilih Opsi" min-h-8="" rounded-box=""></textarea> <input type="hidden" selected> <div relative="" w-full=""><ul menu="" top-0="" hidden absolute="" bg-base="" h-48="" z-10="" overflow-auto="" rounded-box="" shadow=""><li option=""><label flex="" gap-2="" cursor-pointer=""><input type="checkbox" checkbox="" shrink-0="" tabindex="-1"> <div option-label=""></div></label></li></ul></div></div></td></tr>'),_a=h('<div modal=""><div w-5xl="" max-w-full=""><button modal-close="">&times;</button> <!></div></div> <div><div sticky="" top-0="" z-10="" bg-base-a="" pt-15="" pb-3=""><div flex="" gap-5=""><h1 text-xl=""> </h1> <button btn="~ sm circle outline" aria-label="Refresh" p-.5=""><i i-bx-refresh="" animate-reverse=""></i></button></div> <div><div flex=""><a href="../" btn="~ xs"> </a></div></div></div> <div bg-base="" min-h-70vh="" relative=""><!> <div><table table=""><tbody></tbody></table></div></div></div>',!0);const pa=!0;function ca(_t,Kt){ta(Kt,!1);const E={};ea(E);const g=()=>St(C,"$loading",E),L=()=>St(ra,"$t",E);let F=nt(),G="",z=nt(),e=nt();ia(async()=>{G=location.search.replace("?",""),await Q()});async function Q(){I(C,!0),m(F,await B.collection("auditsResult").getList(1,500,{filter:`template.id="indeks_kami_4_2" && (audit.id = "${G}" || audit = "")`,sort:"code",requestKey:"ikami"})),setTimeout(()=>I(C,!1),500)}async function pt(){I(C,!0);try{const d={template:i(e).template,audit:G,question:i(e).id,answer:i(e).answer,score:i(e).score,media:i(e).file?[...i(e).file]:void 0};console.log(d,i(e)),i(e).aid?await B.collection("auditsDetails").update(i(e).aid,d):await B.collection("auditsDetails").create(d),I(Mt,[{action:L()("action.saved")}])}catch(d){console.log(d),I(Mt,[{error:d==null?void 0:d.data}])}m(z,!1),Q()}Ft();var ct=Yt(_t,!0,_a),R=lt(ct),jt=a(R),ft=a(jt),It=t(t(ft,!0)),Lt=t(t(R,!0)),bt=a(Lt),xt=a(bt),mt=a(xt),Rt=s(a(mt)),ht=t(t(mt,!0)),Tt=a(ht),Ht=t(t(xt,!0)),Jt=a(Ht),Nt=a(Jt),Ut=s(a(Nt)),Zt=t(t(bt,!0)),gt=a(Zt),At=t(t(gt,!0)),wt=a(At),Bt=a(wt);y(Rt,()=>L()("audit.indekskami.title")),y(Ut,()=>L()("all.list")),it(()=>{j(Tt,"animate-spin",g()),j(wt,"opacity-50",g())}),rt(R,(d,r)=>da(d,r),()=>i(z)),k("close",R,()=>m(z,!1),!1),k("click",ft,()=>m(z,!1),!1),A(It,()=>i(e),d=>{var r=q(d,!0,la),V=a(r),T=a(V),H=t(t(V,!0)),o=a(H),u=s(a(o)),_=t(t(o,!0)),w=a(_),P=a(w),p=t(t(P,!0)),S=a(p),c=t(t(S,!0));zt(c);var M=t(t(w,!0)),J=a(M),N=t(t(J,!0));Qt(N);var W=t(t(M,!0)),U=a(W),X=t(t(U,!0)),Z=a(X),Y=t(t(H,!0)),$=a(Y),f=a($),tt=t(f,!0);y(tt,()=>` ${ot(L()("save.btn"))}`),it(()=>{x(T,`${ot(i(e).question)} (${ot(i(e).score)})`),x(u,i(e).hint),j(f,"i-bx-save",!g()),j(f,"i-bx-refresh",g()),j(f,"animate-spin",g())}),k("submit",r,Vt(pt),!1),rt(p,(l,D)=>Dt(l,D),()=>i(e).options),vt(c,()=>i(e).score,l=>st(e,i(e).score=l)),vt(N,()=>i(e).answer,l=>st(e,i(e).answer=l)),Gt("files","change","set",U,()=>i(e).file,l=>st(e,i(e).file=l)),ut(Z,()=>i(e).media,9,(l,D,yt)=>{var K=q(l,!0,va),at=a(K);Wt(at,"src",()=>B.files.getUrl(i(e),v(D))),O(l,K)},null),O(d,r)},null),k("click",ht,Q,!1),A(gt,g,d=>{var r=q(d,!0,oa);O(d,r)},null),ut(Bt,()=>{var d;return((d=i(F))==null?void 0:d.items)||[]},9,(d,r,V)=>{var T=Pt(d),H=lt(T);A(H,()=>{var o;return(o=v(r).meta)==null?void 0:o.title},o=>{var u=q(o,!0,sa),_=a(u),w=a(_),P=s(a(w)),p=t(_),S=t(p),c=s(a(S));y(P,()=>v(r).code.split("..").at(0)),y(c,()=>v(r).question),O(o,u)},o=>{var u=q(o,!0,ua),_=a(u),w=a(_),P=s(a(w)),p=t(_),S=s(a(p)),c=t(p),M=a(c),J=a(M),N=s(a(J)),W=t(t(J,!0)),U=a(W),X=s(a(U)),Z=t(t(M,!0)),Y=a(Z);Xt(Y,()=>v(r).answer,!1);var $=t(t(Z,!0)),f=a($),tt=t(t(f,!0)),l=t(c),D=s(a(l)),yt=t(l),K=a(yt),at=a(K),et=t(t(at,!0));zt(et),it(()=>{var n;x(P,v(r).code),x(S,((n=v(r).meta)==null?void 0:n.level)||""),x(N,v(r).question),x(X,v(r).hint),x(D,v(r).score)}),k("click",f,()=>{m(e,v(r)),m(z,!0)},!1),A(tt,()=>v(r).media.length>0,n=>{var b=Pt(n),Ct=lt(b);ut(Ct,()=>v(r).media,1,(kt,Ot,fa)=>{var qt=q(kt,!0,na),Et=s(a(qt));y(Et,()=>v(Ot).substr(0,v(Ot).lastIndexOf("_"))),O(kt,qt)},null),dt(n,b)},null),rt(K,(n,b)=>Dt(n,b),()=>v(r).options),vt(et,()=>v(r).score,n=>(v(r).score=n,aa(()=>{var b;return((b=i(F))==null?void 0:b.items)||[]}))),k("input",et,()=>{m(e,v(r)),pt()},!1),O(o,u)}),dt(d,T)},null),dt(_t,ct),$t()}const qa=Object.freeze(Object.defineProperty({__proto__:null,default:ca,hidden:pa},Symbol.toStringTag,{value:"Module"}));export{ca as _,qa as a};
