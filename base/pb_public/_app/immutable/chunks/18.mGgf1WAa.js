import"./disclose-version.15-3dQtY.js";import{u as Ra,r as X,p as Ta,d as _,g as e,x as Y,e as O,a as Ba,a1 as Z,s as ca,A as l}from"./runtime.N9sK9yCX.js";import{e as B}from"./each.-e9gUnfe.js";import{t as S,G as pa,i as fa,y as ba,z as Fa,a,b as t,x as Ga,F as aa,M as Ha,N as ha,O as Na,c as b,B as Qa,C as $,o as h,s as ta,D as ea,j as Ua,g as Ea,P as Ia,e as Ja,Q as Va,H as Wa,d as c}from"./render.FNm7pgUH.js";import{d as F,l as G,t as ma}from"./db.D4TSvIhG.js";import{o as Xa}from"./main-client.3hV4Kem7.js";import{t as Ya}from"./lang.7t8SORkE.js";import{f as Za,a as at}from"./fnSelect.wqP3uKO_.js";var tt=(D,n)=>_(n,!1),et=c('<div><iframe title="SS"></iframe></div>'),it=c('<form><h1 text-lg="" mb-3=""> </h1> <div h-80vh="" overflow-auto=""><p pb-5=""> </p> <div grid="" grid-cols-1="" gap-5=""><div form-control="" max-w-full=""><span>Opsi Penilaian</span> <div><textarea input="" filter="" placeholder="Pilih Opsi" min-h-8="" rounded-box=""></textarea> <input type="hidden" selected> <div relative="" w-full=""><ul menu="" top-0="" hidden absolute="" bg-base="" h-48="" z-10="" overflow-auto="" rounded-box="" shadow=""><li option=""><label flex="" gap-2="" cursor-pointer=""><input type="checkbox" checkbox="" shrink-0="" tabindex="-1"> <div option-label=""></div></label></li></ul></div></div></div> <div form-control="" max-w-full=""><span>Keterangan</span> <textarea input="" rows="3" h-auto="" rounded-box=""></textarea></div> <div form-control="" max-w-full=""><input type="file" input="" multiple> <div><div carousel="" w-full="" rounded-box="" min-h-40vh="" border=""></div></div></div></div></div> <div><button btn="~ primary"><i></i> </button></div></form>'),rt=c('<div absolute="" top-0="" z-20="" w-full="" h-2="" bg-neutral="" animate-pulse="" animate-count-infinite=""></div>'),dt=(D,n,p)=>e(n).length==e(p)?.items.length?_(n,[]):_(n,e(p)?.items),lt=c('<div underline=""> </div>'),ot=c('<div underline=""> </div>'),vt=c('<tr><td sticky="" left-0=""><input type="checkbox" checkbox=""></td><td><a btn="~ sm"><i i-bx-detail=""></i></a></td><td><div><!></div></td><td> </td><td></td><td></td></tr>'),nt=c('<div modal=""><div w-5xl="" max-w-full=""><button modal-close="">&times;</button> <!></div></div> <div><div sticky="" top-0="" z-10="" bg-base-a="" pt-15="" pb-3=""><div flex="" gap-5=""><h1 text-xl=""> </h1> <button btn="~ sm circle outline" aria-label="Refresh" p-.5=""><i i-bx-refresh="" animate-reverse=""></i></button></div> <div><div flex=""><button btn="~ xs"> </button></div></div></div> <div bg-base="" min-h-70vh="" relative=""><!> <div><table table="" w-full=""><thead><tr children-bg-base-b="" sticky="" top-0=""><th sticky="" left-0="" w-1="" aria-label="Checkbox" h-15=""><input type="checkbox" checkbox=""></th><th></th><th>Ruang Lingkup</th><th>Organisasi</th><th>Auditee</th><th>Auditor</th></tr></thead><tbody></tbody></table></div></div></div>',!0);function st(D,n){Ba(n,!1);const p={};Ra(p);const f=()=>ca(G,"$loading",p),M=()=>ca(Ya,"$t",p),xa=[];let P=Y(),j=Y([]),i=Y();Xa(async()=>{await H()});async function H(){O(G,!0),_(P,await F.collection("audits").getList(1,500,{filter:'template.id="indeks_kami_4_2"',expand:"organization,auditee,auditor",sort:"-created",requestKey:"ikami"})),setTimeout(()=>O(G,!1),500)}async function ga(){O(G,!0);try{const r={template:e(i).template,question:e(i).id,answer:e(i).answer,score:e(i).score,media:e(i).file?[...e(i).file]:void 0};console.log(r,e(i)),e(i).aid?await F.collection("auditsDetails").update(e(i).aid,r):await F.collection("auditsDetails").create(r),O(ma,[{action:M()("action.saved")}])}catch(r){console.log(r),O(ma,[{error:r?.data}])}_(i,!1),H()}var ia=Wa(D,!0,nt),q=Qa(ia),ka=a(q),ra=a(ka),ya=t(t(ra)),wa=t(t(q)),da=a(wa),la=a(da),oa=a(la),za=a(oa),va=t(t(oa)),Oa=a(va),Sa=t(t(la)),$a=a(Sa),Da=a($a),Ma=a(Da),Pa=t(t(da)),na=a(Pa),ja=t(t(na)),sa=a(ja),ua=a(sa),qa=a(ua),Aa=a(qa),N=a(Aa);aa(N);var Ca=t(ua);S(za,()=>M()("audit.indekskami.title")),S(Ma,()=>M()("all.info"));var Q;X(()=>{$(Oa,"animate-spin",f()),$(sa,"opacity-50",f()),Q!==(Q=e(j).length==e(P)?.items.length)&&(N.checked=Q)}),pa(q,(r,d)=>Za(r,d),()=>e(i)),fa("close",q,()=>_(i,!1),!1),ra.__click=[tt,i],ba(ya,()=>e(i),r=>{var d=h(r,!0,it),U=a(d),A=a(U),m=t(t(U)),s=a(m),C=a(s),E=t(t(s)),x=a(E),I=a(x),K=t(t(I)),L=a(K),R=t(t(L));aa(R);var g=t(t(x)),J=a(g),k=t(t(J));Ha(k);var y=t(t(g)),o=a(y),w=t(t(o)),V=a(w),u=t(t(m)),z=a(u),T=a(z),Ka=t(T);S(Ka,()=>` ${ta(M()("save.btn"))}`),X(()=>{ea(A,`${ta(e(i).question)} (${ta(e(i).score)})`),ea(C,e(i).hint),$(T,"i-bx-save",!f()),$(T,"i-bx-refresh",f()),$(T,"animate-spin",f())}),fa("submit",d,Ua(ga),!1),pa(K,(v,W)=>at(v,W),()=>e(i).options),ha(R,()=>e(i).score,v=>Z(i,e(i).score=v)),ha(k,()=>e(i).answer,v=>Z(i,e(i).answer=v)),Na("files","change","set",o,()=>e(i).file,v=>Z(i,e(i).file=v)),B(V,()=>e(i).media,9,(v,W,ut)=>{var _a=h(v,!0,et),La=a(_a);Ea(La,"src",()=>F.files.getUrl(e(i),l(W))),b(v,_a)},null),b(r,d)},null),va.__click=H,ba(na,f,r=>{var d=h(r,!0,rt);b(r,d)},null),N.__click=[dt,j,P],B(Ca,()=>e(P)?.items||[],9,(r,d,U)=>{var A=h(r,!0,vt),m=a(A),s=a(m);aa(s);var C=t(m),E=a(C),x=t(C),I=a(x),K=a(I);Ia(K,()=>l(d).scope,!1);var L=t(x),R=a(L),g=t(L),J=t(g),k,y;X(()=>{k!==(k=l(d))&&(s.value=(s.__value=l(d))==null?"":l(d)),y!==(y="./detail?"+l(d).id)&&Ja(E,"href",y),ea(R,l(d)?.expand?.organization?.name)}),Va(xa,[],s,()=>(l(d),e(j)),o=>_(j,o)),B(g,()=>l(d)?.expand?.auditee||[],9,(o,w,V)=>{var u=h(o,!0,lt),z=a(u);S(z,()=>l(w).name),b(o,u)},null),B(J,()=>l(d)?.expand?.auditor||[],9,(o,w,V)=>{var u=h(o,!0,ot),z=a(u);S(z,()=>l(w).name),b(o,u)},null),b(r,A)},null),Fa(D,ia),Ta()}Ga(["click"]);const gt=Object.freeze(Object.defineProperty({__proto__:null,default:st},Symbol.toStringTag,{value:"Module"}));export{st as _,gt as a};
