import"./disclose-version.15-3dQtY.js";import{u as Ra,r as X,p as Ta,z as _,y as e,q as Y,b as O,a as Ba,a1 as Z,s as ca,A as l}from"./runtime.bbI-llpg.js";import{e as B}from"./each.EYzjG2Rp.js";import{t as S,F as pa,g as fa,w as ba,x as Ea,a,b as t,v as Fa,E as aa,M as Ga,N as ha,O as Na,c as b,z as Qa,A as $,o as h,s as ta,C as ea,p as Ua,f as Ha,P as Ia,B as Ja,Q as Va,G as Wa,d as c}from"./render.xdaRgOar.js";import{d as E,l as F,t as ma}from"./db.XUqTm4OR.js";import{o as Xa}from"./main-client.tx5f1FhV.js";import{t as Ya}from"./lang.ucBuaWId.js";import{f as Za,a as at}from"./fnSelect.wqP3uKO_.js";var tt=(q,n)=>_(n,!1),et=c('<div><iframe title="SS"></iframe></div>'),it=c('<form><h1 text-lg="" mb-3=""> </h1> <div h-80vh="" overflow-auto=""><p pb-5=""> </p> <div grid="" grid-cols-1="" gap-5=""><div form-control="" max-w-full=""><span>Opsi Penilaian</span> <div><textarea input="" filter="" placeholder="Pilih Opsi" min-h-8="" rounded-box=""></textarea> <input type="hidden" selected> <div relative="" w-full=""><ul menu="" top-0="" hidden absolute="" bg-base="" h-48="" z-10="" overflow-auto="" rounded-box="" shadow=""><li option=""><label flex="" gap-2="" cursor-pointer=""><input type="checkbox" checkbox="" shrink-0="" tabindex="-1"> <div option-label=""></div></label></li></ul></div></div></div> <div form-control="" max-w-full=""><span>Keterangan</span> <textarea input="" rows="3" h-auto="" rounded-box=""></textarea></div> <div form-control="" max-w-full=""><input type="file" input="" multiple> <div><div carousel="" w-full="" rounded-box="" min-h-40vh="" border=""></div></div></div></div></div> <div><button btn="~ primary"><i></i> </button></div></form>'),rt=c('<div absolute="" top-0="" z-20="" w-full="" h-2="" bg-neutral="" animate-pulse="" animate-count-infinite=""></div>'),dt=(q,n,p)=>e(n).length==e(p)?.items.length?_(n,[]):_(n,e(p)?.items),lt=c('<div underline=""> </div>'),vt=c('<div underline=""> </div>'),ot=c('<tr><td sticky="" left-0=""><input type="checkbox" checkbox=""></td><td><a btn="~ sm"><i i-bx-detail=""></i></a></td><td><div><!></div></td><td> </td><td></td><td></td></tr>'),nt=c('<div modal=""><div w-5xl="" max-w-full=""><button modal-close="">&times;</button> <!></div></div> <div><div sticky="" top-0="" z-10="" bg-base-a="" pt-15="" pb-3=""><div flex="" gap-5=""><h1 text-xl=""> </h1> <button btn="~ sm circle outline" aria-label="Refresh" p-.5=""><i i-bx-refresh="" animate-reverse=""></i></button></div> <div><div flex=""><button btn="~ xs"> </button></div></div></div> <div bg-base="" min-h-70vh="" relative=""><!> <div><table table="" w-full=""><thead><tr children-bg-base-b="" sticky="" top-0=""><th sticky="" left-0="" w-1="" aria-label="Checkbox" h-15=""><input type="checkbox" checkbox=""></th><th></th><th>Ruang Lingkup</th><th>Organisasi</th><th>Auditee</th><th>Auditor</th></tr></thead><tbody></tbody></table></div></div></div>',!0);function st(q,n){Ba(n,!1);const p={};Ra(p);const f=()=>ca(F,"$loading",p),A=()=>ca(Ya,"$t",p),xa=[];let M=Y(),P=Y([]),i=Y();Xa(async()=>{await G()});async function G(){O(F,!0),_(M,await E.collection("audits").getList(1,500,{filter:'template.id="indeks_kami_4_2"',expand:"organization,auditee,auditor",sort:"-created",requestKey:"ikami"})),setTimeout(()=>O(F,!1),500)}async function ga(){O(F,!0);try{const r={template:e(i).template,question:e(i).id,answer:e(i).answer,score:e(i).score,media:e(i).file?[...e(i).file]:void 0};console.log(r,e(i)),e(i).aid?await E.collection("auditsDetails").update(e(i).aid,r):await E.collection("auditsDetails").create(r),O(ma,[{action:A()("action.saved")}])}catch(r){console.log(r),O(ma,[{error:r?.data}])}_(i,!1),G()}var ia=Wa(q,!0,nt),D=Qa(ia),ka=a(D),ra=a(ka),ya=t(t(ra)),wa=t(t(D)),da=a(wa),la=a(da),va=a(la),za=a(va),oa=t(t(va)),Oa=a(oa),Sa=t(t(la)),$a=a(Sa),qa=a($a),Aa=a(qa),Ma=t(t(da)),na=a(Ma),Pa=t(t(na)),sa=a(Pa),ua=a(sa),Da=a(ua),ja=a(Da),N=a(ja);aa(N);var Ca=t(ua);S(za,()=>A()("audit.indekskami.title")),S(Aa,()=>A()("all.info"));var Q;X(()=>{$(Oa,"animate-spin",f()),$(sa,"opacity-50",f()),Q!==(Q=e(P).length==e(M)?.items.length)&&(N.checked=Q)}),pa(D,(r,d)=>Za(r,d),()=>e(i)),fa("close",D,()=>_(i,!1),!1),ra.__click=[tt,i],ba(ya,()=>e(i),r=>{var d=h(r,!0,it),U=a(d),j=a(U),m=t(t(U)),s=a(m),C=a(s),H=t(t(s)),x=a(H),I=a(x),K=t(t(I)),L=a(K),R=t(t(L));aa(R);var g=t(t(x)),J=a(g),k=t(t(J));Ga(k);var y=t(t(g)),v=a(y),w=t(t(v)),V=a(w),u=t(t(m)),z=a(u),T=a(z),Ka=t(T);S(Ka,()=>` ${ta(A()("save.btn"))}`),X(()=>{ea(j,`${ta(e(i).question)} (${ta(e(i).score)})`),ea(C,e(i).hint),$(T,"i-bx-save",!f()),$(T,"i-bx-refresh",f()),$(T,"animate-spin",f())}),fa("submit",d,Ua(ga),!1),pa(K,(o,W)=>at(o,W),()=>e(i).options),ha(R,()=>e(i).score,o=>Z(i,e(i).score=o)),ha(k,()=>e(i).answer,o=>Z(i,e(i).answer=o)),Na("files","change","set",v,()=>e(i).file,o=>Z(i,e(i).file=o)),B(V,()=>e(i).media,9,(o,W,ut)=>{var _a=h(o,!0,et),La=a(_a);Ha(La,"src",()=>E.files.getUrl(e(i),l(W))),b(o,_a)},null),b(r,d)},null),oa.__click=G,ba(na,f,r=>{var d=h(r,!0,rt);b(r,d)},null),N.__click=[dt,P,M],B(Ca,()=>e(M)?.items||[],9,(r,d,U)=>{var j=h(r,!0,ot),m=a(j),s=a(m);aa(s);var C=t(m),H=a(C),x=t(C),I=a(x),K=a(I);Ia(K,()=>l(d).scope,!1);var L=t(x),R=a(L),g=t(L),J=t(g),k,y;X(()=>{k!==(k=l(d))&&(s.value=(s.__value=l(d))==null?"":l(d)),y!==(y="./detail?"+l(d).id)&&Ja(H,"href",y),ea(R,l(d)?.expand?.organization?.name)}),Va(xa,[],s,()=>(l(d),e(P)),v=>_(P,v)),B(g,()=>l(d)?.expand?.auditee||[],9,(v,w,V)=>{var u=h(v,!0,lt),z=a(u);S(z,()=>l(w).name),b(v,u)},null),B(J,()=>l(d)?.expand?.auditor||[],9,(v,w,V)=>{var u=h(v,!0,vt),z=a(u);S(z,()=>l(w).name),b(v,u)},null),b(r,j)},null),Ea(q,ia),Ta()}Fa(["click"]);const gt=Object.freeze(Object.defineProperty({__proto__:null,default:st},Symbol.toStringTag,{value:"Module"}));export{st as _,gt as a};
